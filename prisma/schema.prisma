generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider          = "mysql"
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

model User {
  id                 String    @id @default(uuid())
  name               String
  email              String?   @unique
  phone              String    @unique
  password           String
  role               role      @default(Consumer)
  address            String
  public_id          String?
  url                String?   @default("https://res.cloudinary.com/delu47omx/image/upload/v1725515799/avater_zdqflq.jpg")
  status             status    @default(green)
  isActive           Boolean   @default(true)
  activationToken    String?   @db.LongText
  passwordResetToken String?   @db.LongText
  passwordChangeAt   DateTime?
  createdAt          DateTime  @default(now())
  vehicleDriver      Vehicle[] @relation("driverRelation")
  vehicleSupervisor  Vehicle[] @relation("supervisorRelation")

  @@map("users")
}

model Vehicle {
  id           String  @id @default(uuid())
  vNumber      String  @unique
  route        String
  runningRoute String?
  oil          Int     @default(0)
  income       Int     @default(0)
  expense      Int     @default(0)
  savings      Int     @default(0)
  welfare      Int     @default(0)
  servicing    Int     @default(0)
  comment      String?

  driverId     String
  driver       User   @relation("driverRelation", fields: [driverId], references: [id])
  supervisorId String
  supervisor   User   @relation("supervisorRelation", fields: [supervisorId], references: [id])

  vehicleStatements VehicleStatement[]

  createdAt DateTime @default(now())

  @@map("vehicles")
}

model VehicleRoute {
  id   String @id @default(uuid())
  name String @unique

  createdAt DateTime @default(now())

  @@map("vehicleRoutes")
}

model VehicleStatement {
  id        String  @id @default(uuid())
  date      String
  route     String
  oil       Int
  income    Int
  expense   Int
  welfare   Int     @default(0)
  servicing Int     @default(0)
  comment   String?

  vehicleId String
  vehicle   Vehicle @relation(fields: [vehicleId], references: [id])

  createdAt DateTime @default(now())

  @@map("vehicleStatements")
}

enum role {
  Consumer
  Retailer
  Staff
  Manager
  Owner
}

enum status {
  green
  red
}
